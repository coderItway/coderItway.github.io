import{_ as c}from"./chunks/ArticleMetadata.f06b230e.js";import{_ as t,i as r,o as l,c as i,g as y,w as C,e as B,j as A,b as p,f as d,a as F}from"./app.f6f466d0.js";const D="/vitepress-blog/assets/202210282235156.aacc81a2.png",E="/vitepress-blog/assets/202210282236211.fd67d645.png",v=JSON.parse('{"title":"Docker 安装 MinIO 详细步骤","description":"","frontmatter":{"title":"Docker 安装 MinIO 详细步骤","author":"查尔斯","date":"2022/10/28 22:37","categories":["杂碎逆袭史"],"tags":["MinIO","Docker","容器"],"showComment":false},"headers":[{"level":2,"title":"拉取镜像","slug":"拉取镜像","link":"#拉取镜像","children":[]},{"level":2,"title":"运行容器","slug":"运行容器","link":"#运行容器","children":[]},{"level":2,"title":"验证","slug":"验证","link":"#验证","children":[]},{"level":2,"title":"Docker Compose脚本","slug":"docker-compose脚本","link":"#docker-compose脚本","children":[]}],"relativePath":"categories/fragments/2022/10/28/Docker安装MinIO.md","lastUpdated":1672153722000}'),m={name:"categories/fragments/2022/10/28/Docker安装MinIO.md"},_=p("h1",{id:"docker-安装-minio-详细步骤",tabindex:"-1"},[d("Docker 安装 MinIO 详细步骤 "),p("a",{class:"header-anchor",href:"#docker-安装-minio-详细步骤","aria-hidden":"true"},"#")],-1),I=F(`<div class="tip custom-block"><p class="custom-block-title">笔者说</p><p>笔者下面的步骤及配置是基于指定版本的实践，大多数程序大多数情况下在相差不大的版本时可以直接参考。（当然了，即使是非 Docker 方式安装程序也是一样道理）</p></div><h2 id="拉取镜像" tabindex="-1">拉取镜像 <a class="header-anchor" href="#拉取镜像" aria-hidden="true">#</a></h2><div class="warning custom-block"><p class="custom-block-title">笔者说</p><p>拉取镜像时需要明确镜像版本（Tag）。</p></div><p>不指定版本（Tag）就拉取镜像，那拉取下来的镜像版本（Tag）默认是 <code>latest</code>（最新的）。<code>latest</code> 会跟随 Docker Registry 中的记录变化，现在拉取下来的 <code>latest</code> 是 x1 版本，但隔了一段时间后你在其他机器上再拉取 <code>latest</code> 可能就是 x2 版本了。</p><p>变化的版本，不利于生产环境部署的稳定。无论是后续在其他环境部署还是扩容集群等场景均要求根据架构要求指定好版本。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#ABB2BF;">docker pull minio/minio:RELEASE.2022-08-02T23-59-16Z.fips</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A6ACCD;">docker pull minio/minio:RELEASE.2022-08-02T23-59-16Z.fips</span></span>
<span class="line"></span></code></pre></div><h2 id="运行容器" tabindex="-1">运行容器 <a class="header-anchor" href="#运行容器" aria-hidden="true">#</a></h2><div class="warning custom-block"><p class="custom-block-title">笔者说</p><p><strong>下方的配置，切记要根据个人实际情况来修改。</strong></p></div><ul><li>容器的名称</li><li>镜像名称:版本</li><li>是否设置自启动？</li><li>是否端口映射？</li><li>环境变量配置</li><li>映射的话映射到宿主机哪个端口？</li><li>是否挂载卷？</li><li>挂载的话要挂载宿主机哪个目录？</li><li>......</li><li>等自定义配置</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#7F848E;"># MINIO_ACCESS_KEY：用户名，默认为 minioadmin</span></span>
<span class="line"><span style="color:#7F848E;"># MINIO_SECRET_KEY：用户密码，默认为 minioadmin</span></span>
<span class="line"><span style="color:#7F848E;"># MINIO_COMPRESS：开启压缩 on 开启 off 关闭</span></span>
<span class="line"><span style="color:#7F848E;"># MINIO_COMPRESS_EXTENSIONS：扩展名 .pdf,.doc 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#7F848E;"># MINIO_COMPRESS_MIME_TYPES：mime 类型 application/pdf 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#7F848E;"># MINIO_SERVER_URL：HTTPS 需要指定服务域名，例如：https://xxx.com:9000</span></span>
<span class="line"><span style="color:#7F848E;"># MINIO_BROWSER_REDIRECT_URL：HTTPS 需要指定服务域名，例如：https://xxx.com:9001</span></span>
<span class="line"><span style="color:#ABB2BF;">docker run -d \\</span></span>
<span class="line"><span style="color:#ABB2BF;">--name minio minio/minio:RELEASE.2022-08-02T23-59-16Z.fips \\</span></span>
<span class="line"><span style="color:#ABB2BF;">--restart=always \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-e TZ=</span><span style="color:#98C379;">&quot;Asia/Shanghai&quot;</span><span style="color:#ABB2BF;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-e MINIO_ACCESS_KEY=</span><span style="color:#98C379;">&quot;minioadmin&quot;</span><span style="color:#ABB2BF;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-e MINIO_SECRET_KEY=</span><span style="color:#98C379;">&quot;minioadmin&quot;</span><span style="color:#ABB2BF;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-e MINIO_COMPRESS=</span><span style="color:#98C379;">&quot;off&quot;</span><span style="color:#ABB2BF;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-e MINIO_COMPRESS_EXTENSIONS=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-e MINIO_COMPRESS_MIME_TYPES=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-p 9000:9000 -p 9001:9001 \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-v /opt/disk/docker/volumes/minio/conf:/root/.minio \\</span></span>
<span class="line"><span style="color:#ABB2BF;">-v /opt/disk/docker/volumes/minio/data:/data \\</span></span>
<span class="line"><span style="color:#ABB2BF;">server --address </span><span style="color:#98C379;">&#39;:9000&#39;</span><span style="color:#ABB2BF;"> --console-address </span><span style="color:#98C379;">&#39;:9001&#39;</span><span style="color:#ABB2BF;"> /data \\</span></span>
<span class="line"><span style="color:#7F848E;"># 使用该参数，容器内的 root 用户才拥有真正的 root 权限</span></span>
<span class="line"><span style="color:#ABB2BF;">--privileged=true</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#676E95;"># MINIO_ACCESS_KEY：用户名，默认为 minioadmin</span></span>
<span class="line"><span style="color:#676E95;"># MINIO_SECRET_KEY：用户密码，默认为 minioadmin</span></span>
<span class="line"><span style="color:#676E95;"># MINIO_COMPRESS：开启压缩 on 开启 off 关闭</span></span>
<span class="line"><span style="color:#676E95;"># MINIO_COMPRESS_EXTENSIONS：扩展名 .pdf,.doc 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#676E95;"># MINIO_COMPRESS_MIME_TYPES：mime 类型 application/pdf 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#676E95;"># MINIO_SERVER_URL：HTTPS 需要指定服务域名，例如：https://xxx.com:9000</span></span>
<span class="line"><span style="color:#676E95;"># MINIO_BROWSER_REDIRECT_URL：HTTPS 需要指定服务域名，例如：https://xxx.com:9001</span></span>
<span class="line"><span style="color:#A6ACCD;">docker run -d \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--name minio minio/minio:RELEASE.2022-08-02T23-59-16Z.fips \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--restart=always \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-e TZ=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Asia/Shanghai</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-e MINIO_ACCESS_KEY=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">minioadmin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-e MINIO_SECRET_KEY=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">minioadmin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-e MINIO_COMPRESS=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">off</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-e MINIO_COMPRESS_EXTENSIONS=</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-e MINIO_COMPRESS_MIME_TYPES=</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-p 9000:9000 -p 9001:9001 \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-v /opt/disk/docker/volumes/minio/conf:/root/.minio \\</span></span>
<span class="line"><span style="color:#A6ACCD;">-v /opt/disk/docker/volumes/minio/data:/data \\</span></span>
<span class="line"><span style="color:#A6ACCD;">server --address </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">:9000</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> --console-address </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">:9001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> /data \\</span></span>
<span class="line"><span style="color:#676E95;"># 使用该参数，容器内的 root 用户才拥有真正的 root 权限</span></span>
<span class="line"><span style="color:#A6ACCD;">--privileged=true</span></span>
<span class="line"></span></code></pre></div><h2 id="验证" tabindex="-1">验证 <a class="header-anchor" href="#验证" aria-hidden="true">#</a></h2><p>服务器开放好相应端口或设置好安全组规则后，访问 <code>http://宿主机IP:映射的端口</code> （例如按上方配置那就是：<a href="http://xn--IP-wz2c754c5qn:9001" target="_blank" rel="noreferrer">http://宿主机IP:9001</a>）即可看到 MinIO 管理界面。</p><p><img src="`+D+'" alt="202210282235156"></p><p>输入你刚才指定的用户名、密码，登录进来后，可以看到当前一个 Bucket 也没有，可以点击右侧的 [Create Bucket] 来创建。</p><p><img src="'+E+`" alt="202210282236211"></p><h2 id="docker-compose脚本" tabindex="-1">Docker Compose脚本 <a class="header-anchor" href="#docker-compose脚本" aria-hidden="true">#</a></h2><p>如果你是用的 docker-compose 来安装，下方附上相应 docker-compose.yml 脚本内容。</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#E06C75;">version</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;3&#39;</span></span>
<span class="line"><span style="color:#E06C75;">services</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">minio</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">container_name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">minio</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">image</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">minio/minio:RELEASE.2022-08-02T23-59-16Z.fips</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">restart</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">always</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">environment</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">TZ</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">Asia/Shanghai</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">MINIO_ACCESS_KEY</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">minioadmin</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">MINIO_SECRET_KEY</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">minioadmin</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;"># HTTPS 需要指定域名</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;">#MINIO_SERVER_URL: &#39;https://xxx.com:9000&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;">#MINIO_BROWSER_REDIRECT_URL: &#39;https://xxx.com:9001&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;"># 开启压缩 on 开启 off 关闭</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">MINIO_COMPRESS</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;off&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;"># 扩展名 .pdf,.doc 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">MINIO_COMPRESS_EXTENSIONS</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#7F848E;"># mime 类型 application/pdf 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E06C75;">MINIO_COMPRESS_MIME_TYPES</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ports</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">      - </span><span style="color:#98C379;">9000:9000</span></span>
<span class="line"><span style="color:#ABB2BF;">      - </span><span style="color:#98C379;">9001:9001</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">volumes</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">      - </span><span style="color:#98C379;">/opt/disk/docker/volumes/minio/conf:/root/.minio</span></span>
<span class="line"><span style="color:#ABB2BF;">      - </span><span style="color:#98C379;">/opt/disk/docker/volumes/minio/data:/data</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">command</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">server --address &#39;:9000&#39; --console-address &#39;:9001&#39; /data</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">privileged</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">minio</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">container_name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">minio</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">minio/minio:RELEASE.2022-08-02T23-59-16Z.fips</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">TZ</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Asia/Shanghai</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MINIO_ACCESS_KEY</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">minioadmin</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MINIO_SECRET_KEY</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">minioadmin</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># HTTPS 需要指定域名</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">#MINIO_SERVER_URL: &#39;https://xxx.com:9000&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">#MINIO_BROWSER_REDIRECT_URL: &#39;https://xxx.com:9001&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># 开启压缩 on 开启 off 关闭</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MINIO_COMPRESS</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">off</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># 扩展名 .pdf,.doc 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MINIO_COMPRESS_EXTENSIONS</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;"># mime 类型 application/pdf 为空 所有类型均压缩</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MINIO_COMPRESS_MIME_TYPES</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">9000:9000</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">9001:9001</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/opt/disk/docker/volumes/minio/conf:/root/.minio</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/opt/disk/docker/volumes/minio/data:/data</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">server --address &#39;:9000&#39; --console-address &#39;:9001&#39; /data</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">privileged</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"></span></code></pre></div><p>编写好 docker-compose.yml 脚本后，在脚本同级目录执行下方命令即可。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki vp-code-dark"><code><span class="line"><span style="color:#ABB2BF;">docker-compose up -d</span></span>
<span class="line"></span></code></pre><pre class="shiki vp-code-light"><code><span class="line"><span style="color:#A6ACCD;">docker-compose up -d</span></span>
<span class="line"></span></code></pre></div>`,20);function S(s,u,h,M,O,k){const o=c,e=r("ClientOnly");return l(),i("div",null,[_,y(e,null,{default:C(()=>{var n,a;return[(((n=s.$frontmatter)==null?void 0:n.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!1)?(l(),B(o,{key:0,article:s.$frontmatter},null,8,["article"])):A("",!0)]}),_:1}),I])}const N=t(m,[["render",S]]);export{v as __pageData,N as default};
